# Flag Format
Every flag string used on the platform is of the format `flag{0123456789abcdef}`, where `0123456789abcdef` is 16-characters of hexidecimal. There are no exceptions to this rule -- therefore it's easy for participants (and the client side) to perform a basic sanity check before trying to submit a flag. Flags are also generated procedurally by the server for each team, so there'll never be a message intentionally hidden in a flag -- it'll basically just be 16 random hex characters.

## Flag Generation
Flag generation is handled by the [flag manager](/models/flag_manager.py). Flags are generated using the following algorithm.

```
HMAC_SHA256(event_secret_key, ";".join(['FLAG', event_name, challenge.slug, team.slug])).hexdigest().lower()[:16]
```

We join the constant string `FLAG` with the event name, challenge ID, and team ID a semicolon (`;`). We then take that as a message to perform an HMAC SHA256 signature on, and take the first 16 characters of the lowercase hex digest of that signature to be our flag.

This is a great approach for per-team flag generation as the HMAC proves that the flag must have been generated by a key-holding server, and the algorithm is deterministic. This means that given multiple servers share the same event key, challenge ID and team IDs (which they would if all connected to the same db), then they will all generate the same flags and be able to validate them without actually needing to communicate between server instances at all. This allows for an incredibly scalable and stable approach with multiple platform servers running in parallel to load-balance. This is ideal for larger events.
